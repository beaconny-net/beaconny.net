
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>South Ave Book Sale Credit Card Fee Calculator</title>

    <style>
     body {
       display: flex;
       height: 100%;
       background: #203EA0;
       color: #EDB506;
     }

     #wrapper {
       margin: 1rem auto;
     }

     label {
       font-size: 1.5rem;
       display: block;
       text-align: right;
       font-weight: bold;
     }

     p {
       font-size: 2rem;
       margin-top: 0.5rem;
     }

     input {
       text-align: right;
       margin-left: 0.2rem;
       width: 75vw;
       padding: 1rem;
       font-size: 2rem;
     }


     input[type="number"]::-webkit-outer-spin-button,
     input[type="number"]::-webkit-inner-spin-button {
       -webkit-appearance: none;
       margin: 0;
     }
     input[type="number"] {
       -moz-appearance: textfield;
     }

     button {
       font-size: 2rem;
       float: right;
     }
    </style>

    <script>
     const FEE_PERCENT = Number("2.60");
     const FLAT_FEE = Number("0.15");

     // Tests cases copied from original spreadsheet.
     const TEST_SALE_CHARGE_PAIRS = [
       ["1.00", "1.18"],
       ["5.00", "5.29"],
       ["10.00", "10.42"],
       ["15.00", "15.55"],
       ["20.00", "20.69"],
       ["25.00", "25.82"],
       ["30.00", "30.95"],
       ["35.00", "36.09"],
       ["40.00", "41.22"],
       ["45.00", "46.36"],
       ["50.00", "51.49"],
       ["55.00", "56.62"],
       ["60.00", "61.76"],
       ["65.00", "66.89"],
       ["70.00", "72.02"],
       ["75.00", "77.16"],
       ["80.00", "82.29"],
       ["85.00", "87.42"],
       ["90.00", "92.56"],
       ["95.00", "97.69"],
       ["100.00", "102.82"]
     ];

     function calc(salePrice) {
       return Math.round((salePrice + FLAT_FEE) / (1 - FEE_PERCENT / 100) * 100) / 100;
     }

     // Test calc().
     for (const [sale, charge] of TEST_SALE_CHARGE_PAIRS) {
       if (calc(Number(sale)) !== Number(charge)) {
         console.error(`calc(${sale}) != ${charge}`);
       }
     }

     function init() {
       const [ccAmount, saleAmount] = Array.from(document.querySelectorAll("input"));

       saleAmount.addEventListener("input", e => {
         const { value } = e.target;
         ccAmount.value = calc(Number(value)).toFixed(2);
       });

       saleAmount.addEventListener("focus", e => e.target.select());

       document.querySelector("button").addEventListener("click", () => {
         saleAmount.value = "0.00"
         ccAmount.value = "0.00";
         saleAmount.focus()
       });

     }
     document.addEventListener("DOMContentLoaded", init);
    </script>

  </head>

  <body>
    <div id="wrapper">
      <label>Credit Card Amount
        <p>
          $<input type="number" min="0" step="0.01" value="0.00" readonly>
        </p>
      </label>

      <label>Sale Amount
        <p>
          $<input type="number" min="0" step="0.01" value="0.00">
        </p>
      </label>
      <button>Clear</button>
    </div>
  </body>
</html>
